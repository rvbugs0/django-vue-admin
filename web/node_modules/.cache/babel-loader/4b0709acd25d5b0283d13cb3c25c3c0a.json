{"remainingRequest":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js!/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/raviailani/Downloads/django-vue-admin/web/src/views/system/config/components/addContent.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/raviailani/Downloads/django-vue-admin/web/src/views/system/config/components/addContent.vue","mtime":1674694301490},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/babel.config.js","mtime":1674694301461},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js","mtime":1674694549283},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js","mtime":1674694549360}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy9yYXZpYWlsYW5pL0Rvd25sb2Fkcy9kamFuZ28tdnVlLWFkbWluL3dlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgKiBhcyBhcGkgZnJvbSAnLi4vYXBpJzsKaW1wb3J0IGFzc29jaWF0aW9uVGFibGUgZnJvbSAnLi9jb21wb25lbnRzL2Fzc29jaWF0aW9uVGFibGUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2FkZENvbnRlbnQnLAogIGluamVjdDogWydyZWZyZXNoVmlldyddLAogIGNvbXBvbmVudHM6IHsKICAgIGFzc29jaWF0aW9uVGFibGU6IGFzc29jaWF0aW9uVGFibGUKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmb3JtOiB7CiAgICAgICAgcGFyZW50OiBudWxsLAogICAgICAgIHRpdGxlOiBudWxsLAogICAgICAgIGtleTogbnVsbCwKICAgICAgICBmb3JtX2l0ZW1fdHlwZTogbnVsbCwKICAgICAgICBydWxlOiBudWxsLAogICAgICAgIHBsYWNlaG9sZGVyOiBudWxsCiAgICAgIH0sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgcGFyZW50OiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36YCJ5oupJwogICAgICAgIH1dLAogICAgICAgIHRpdGxlOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWlJwogICAgICAgIH1dLAogICAgICAgIGtleTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpScKICAgICAgICB9LCB7CiAgICAgICAgICBwYXR0ZXJuOiAvXltBLVphLXowLTlfXSskLywKICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmlbDlrZfjgIHlrZfmr43miJbkuIvliJLnur8nCiAgICAgICAgfV0sCiAgICAgICAgZm9ybV9pdGVtX3R5cGU6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaUnCiAgICAgICAgfV0KICAgICAgfSwKICAgICAgLy8g54i257qn5YaF5a65CiAgICAgIHBhcmVudE9wdGlvbnM6IFtdLAogICAgICBydWxlT3B0aW9uczogW3sKICAgICAgICBsYWJlbDogJ+W/heWhq+mhuScsCiAgICAgICAgdmFsdWU6ICd7InJlcXVpcmVkIjogdHJ1ZSwgIm1lc3NhZ2UiOiAi5b+F5aGr6aG55LiN6IO95Li656m6In0nCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ+mCrueusScsCiAgICAgICAgdmFsdWU6ICd7ICJ0eXBlIjogImVtYWlsIiwgIm1lc3NhZ2UiOiAi6K+36L6T5YWl5q2j56Gu55qE6YKu566x5Zyw5Z2AIn0nCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ1VSTOWcsOWdgCcsCiAgICAgICAgdmFsdWU6ICd7ICJ0eXBlIjogInVybCIsICJtZXNzYWdlIjogIuivt+i+k+WFpeato+ehrueahFVSTOWcsOWdgCJ9JwogICAgICB9XQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFBhcmVudDogZnVuY3Rpb24gZ2V0UGFyZW50KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBhcGkuR2V0TGlzdCh7CiAgICAgICAgcGFyZW50X19pc251bGw6IHRydWUsCiAgICAgICAgbGltaXQ6IDk5OQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgX3RoaXMucGFyZW50T3B0aW9ucyA9IGRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOaPkOS6pAogICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGF0LmFzc29jaWF0aW9uVGFibGVVcGRhdGUoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgZm9ybSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhhdC5mb3JtKSk7CiAgICAgICAgdmFyIHJ1bGVzID0gW107CiAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGZvcm0ucnVsZSksCiAgICAgICAgICBfc3RlcDsKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgdmFyIHN0clRvT2JqID0gSlNPTi5wYXJzZShpdGVtKTsKICAgICAgICAgICAgcnVsZXMucHVzaChzdHJUb09iaik7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgICBmb3JtLnJ1bGUgPSBydWxlczsKICAgICAgICB0aGF0LiRyZWZzLmZvcm0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICAgYXBpLmNyZWF0ZU9iaihmb3JtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczIuJG1lc3NhZ2Uuc3VjY2Vzcygn5paw5aKe5oiQ5YqfJyk7CiAgICAgICAgICAgICAgX3RoaXMyLnJlZnJlc2hWaWV3KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5YWz6IGU6KGo5pWw5o2u5pu05pawCiAgICBhc3NvY2lhdGlvblRhYmxlVXBkYXRlOiBmdW5jdGlvbiBhc3NvY2lhdGlvblRhYmxlVXBkYXRlKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgaWYgKHRoYXQuJHJlZnMuYXNzb2NpYXRpb25UYWJsZSkgewogICAgICAgICAgaWYgKCF0aGF0LiRyZWZzLmFzc29jaWF0aW9uVGFibGUub25TdWJtaXQoKSkgewogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLXByb21pc2UtcmVqZWN0LWVycm9ycwogICAgICAgICAgICByZXR1cm4gcmVqZWN0KGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBmb3JtT2JqID0gdGhhdC4kcmVmcy5hc3NvY2lhdGlvblRhYmxlLmZvcm1PYmo7CiAgICAgICAgICB0aGF0LmZvcm0uc2V0dGluZyA9IGZvcm1PYmo7CiAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFBhcmVudCgpOwogIH0KfTs="},{"version":3,"mappings":";;;;AAoDA;AACA;AAEA;EACAA;EACAC;EACAC;IACAC;EACA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAN,SACA;UACAO;UACAC;QACA,EACA;QACAP,QACA;UACAM;UACAC;QACA,EACA;QACAN,MACA;UACAK;UACAC;QACA,GACA;UACAC;UACAD;QACA,EACA;QACAL,iBACA;UACAI;UACAC;QACA;MAEA;MACA;MACAE;MACAC,cACA;QACAC;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA;IAEA;EACA;EACAC;IACAC;MAAA;MACAC;QACAC;QACAC;MACA;QACA;QACA;MACA;IACA;IACA;IACAC;MAAA;MACA;MACAC;QACA;QACA;QAAA,2CACArB;UAAA;QAAA;UAAA;YAAA;YACA;YACAO;UACA;QAAA;UAAA;QAAA;UAAA;QAAA;QACAP;QACAqB;UACA;YACAJ;cACA;cACA;YACA;UACA;YACAK;YACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACA;YACA;YACA;UACA;UACA;UACAF;UACA;QACA;UACA;QACA;MACA;IACA;EACA;EACAG;IACA;EACA;AACA","names":["name","inject","components","associationTable","data","form","parent","title","key","form_item_type","rule","placeholder","rules","required","message","pattern","parentOptions","ruleOptions","label","value","methods","getParent","api","parent__isnull","limit","onSubmit","that","console","associationTableUpdate","created"],"sourceRoot":"src/views/system/config/components","sources":["addContent.vue"],"sourcesContent":["<template>\n  <div style=\"padding: 20px\">\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\n      <el-form-item label=\"所属分组\" prop=\"parent\">\n        <el-select v-model=\"form.parent\" placeholder=\"请选择分组\" clearable>\n          <el-option :label=\"item.title\" :value=\"item.id\" :key=\"index\"\n                     v-for=\"(item,index) in parentOptions\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"标题\" prop=\"title\">\n        <el-input v-model=\"form.title\" placeholder=\"请输入\" clearable></el-input>\n      </el-form-item>\n      <el-form-item label=\"key值\" prop=\"key\">\n        <el-input v-model=\"form.key\" placeholder=\"请输入\" clearable></el-input>\n      </el-form-item>\n      <el-form-item label=\"表单类型\" prop=\"form_item_type\">\n        <el-select v-model=\"form.form_item_type\" placeholder=\"请选择\" clearable>\n          <el-option :label=\"item.label\" :value=\"item.value\" :key=\"index\"\n                     v-for=\"(item,index) in dictionary('config_form_type')\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item\n        v-if=\"[4,5,6].indexOf(form.form_item_type)>-1\"\n        label=\"字典key\"\n        prop=\"setting\"\n        :rules=\"[{required: true,message: '不能为空'}]\">\n        <el-input v-model=\"form.setting\" placeholder=\"请输入dictionary中key值\" clearable></el-input>\n      </el-form-item>\n      <div v-if=\"[13,14].indexOf(form.form_item_type)>-1\">\n        <associationTable ref=\"associationTable\" v-model=\"form.setting\"\n                          @updateVal=\"associationTableUpdate\"></associationTable>\n      </div>\n      <el-form-item label=\"校验规则\">\n        <el-select v-model=\"form.rule\" multiple placeholder=\"请选择(可多选)\" clearable>\n          <el-option :label=\"item.label\" :value=\"item.value\" :key=\"index\"\n                     v-for=\"(item,index) in ruleOptions\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"提示信息\" prop=\"placeholder\">\n        <el-input v-model=\"form.placeholder\" placeholder=\"请输入\" clearable></el-input>\n      </el-form-item>\n      <el-form-item label=\"排序\" prop=\"sort\">\n        <el-input-number v-model=\"form.sort\" :min=\"0\" :max=\"99\"></el-input-number>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"onSubmit\">立即创建</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport * as api from '../api'\nimport associationTable from './components/associationTable'\n\nexport default {\n  name: 'addContent',\n  inject: ['refreshView'],\n  components: {\n    associationTable\n  },\n  data () {\n    return {\n      form: {\n        parent: null,\n        title: null,\n        key: null,\n        form_item_type: null,\n        rule: null,\n        placeholder: null\n      },\n      rules: {\n        parent: [\n          {\n            required: true,\n            message: '请选择'\n          }\n        ],\n        title: [\n          {\n            required: true,\n            message: '请输入'\n          }\n        ],\n        key: [\n          {\n            required: true,\n            message: '请输入'\n          },\n          {\n            pattern: /^[A-Za-z0-9_]+$/,\n            message: '请输入数字、字母或下划线'\n          }\n        ],\n        form_item_type: [\n          {\n            required: true,\n            message: '请输入'\n          }\n        ]\n      },\n      // 父级内容\n      parentOptions: [],\n      ruleOptions: [\n        {\n          label: '必填项',\n          value: '{\"required\": true, \"message\": \"必填项不能为空\"}'\n        },\n        {\n          label: '邮箱',\n          value: '{ \"type\": \"email\", \"message\": \"请输入正确的邮箱地址\"}'\n        },\n        {\n          label: 'URL地址',\n          value: '{ \"type\": \"url\", \"message\": \"请输入正确的URL地址\"}'\n        }\n      ]\n    }\n  },\n  methods: {\n    getParent () {\n      api.GetList({\n        parent__isnull: true,\n        limit: 999\n      }).then(res => {\n        const { data } = res.data\n        this.parentOptions = data\n      })\n    },\n    // 提交\n    onSubmit () {\n      const that = this\n      that.associationTableUpdate().then(() => {\n        const form = JSON.parse(JSON.stringify(that.form))\n        const rules = []\n        for (const item of form.rule) {\n          const strToObj = JSON.parse(item)\n          rules.push(strToObj)\n        }\n        form.rule = rules\n        that.$refs.form.validate((valid) => {\n          if (valid) {\n            api.createObj(form).then(res => {\n              this.$message.success('新增成功')\n              this.refreshView()\n            })\n          } else {\n            console.log('error submit!!')\n            return false\n          }\n        })\n      })\n    },\n    // 关联表数据更新\n    associationTableUpdate () {\n      const that = this\n      return new Promise(function (resolve, reject) {\n        if (that.$refs.associationTable) {\n          if (!that.$refs.associationTable.onSubmit()) {\n            // eslint-disable-next-line prefer-promise-reject-errors\n            return reject(false)\n          }\n          const { formObj } = that.$refs.associationTable\n          that.form.setting = formObj\n          return resolve(true)\n        } else {\n          return resolve(true)\n        }\n      })\n    }\n  },\n  created () {\n    this.getParent()\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}