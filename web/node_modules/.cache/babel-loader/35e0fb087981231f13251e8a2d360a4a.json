{"remainingRequest":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js!/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/raviailani/Downloads/django-vue-admin/web/src/layout/header-aside/components/panel-search/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/raviailani/Downloads/django-vue-admin/web/src/layout/header-aside/components/panel-search/index.vue","mtime":1674694301485},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/babel.config.js","mtime":1674694301461},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js","mtime":1674694549283},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js","mtime":1674694549360}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL3JhdmlhaWxhbmkvRG93bmxvYWRzL2RqYW5nby12dWUtYWRtaW4vd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL3JhdmlhaWxhbmkvRG93bmxvYWRzL2RqYW5nby12dWUtYWRtaW4vd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3JhdmlhaWxhbmkvRG93bmxvYWRzL2RqYW5nby12dWUtYWRtaW4vd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgRnVzZSBmcm9tICdmdXNlLmpzJzsKaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IG1peGluIGZyb20gJy4uL21peGluL21lbnUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbWl4aW5zOiBbbWl4aW5dLAogIGNvbXBvbmVudHM6IHsKICAgICdkMi1wYW5lbC1zZWFyY2gtaXRlbSc6IGZ1bmN0aW9uIGQyUGFuZWxTZWFyY2hJdGVtKCkgewogICAgICByZXR1cm4gaW1wb3J0KCcuL2NvbXBvbmVudHMvcGFuZWwtc2VhcmNoLWl0ZW0vaW5kZXgudnVlJyk7CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VhcmNoVGV4dDogJycsCiAgICAgIHJlc3VsdHM6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbWFwU3RhdGUoJ2QyYWRtaW4vc2VhcmNoJywgWydob3RrZXknLCAncG9vbCddKSksIHt9LCB7CiAgICAvLyDov5nku73mlbDmja7mmK/lsZXnpLrlnKjmkJzntKLpnaLmnb/kuIvpnaLnmoQKICAgIHJlc3VsdHNMaXN0OiBmdW5jdGlvbiByZXN1bHRzTGlzdCgpIHsKICAgICAgcmV0dXJuIHRoaXMucmVzdWx0cy5sZW5ndGggPT09IDAgJiYgdGhpcy5zZWFyY2hUZXh0ID09PSAnJyA/IHRoaXMucG9vbC5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7CiAgICAgICAgICB2YWx1ZTogZS5mdWxsVGl0bGUKICAgICAgICB9LCBlKTsKICAgICAgfSkgOiB0aGlzLnJlc3VsdHM7CiAgICB9LAogICAgLy8g5qC55o2uIHBvb2wg5pu05pawIGZ1c2Ug5a6e5L6LCiAgICBmdXNlOiBmdW5jdGlvbiBmdXNlKCkgewogICAgICByZXR1cm4gbmV3IEZ1c2UodGhpcy5wb29sLCB7CiAgICAgICAgc2hvdWxkU29ydDogdHJ1ZSwKICAgICAgICB0b2tlbml6ZTogdHJ1ZSwKICAgICAgICB0aHJlc2hvbGQ6IDAuNiwKICAgICAgICBsb2NhdGlvbjogMCwKICAgICAgICBkaXN0YW5jZTogMTAwLAogICAgICAgIG1heFBhdHRlcm5MZW5ndGg6IDMyLAogICAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aDogMSwKICAgICAgICBrZXlzOiBbJ2Z1bGxUaXRsZScsICdwYXRoJ10KICAgICAgfSk7CiAgICB9CiAgfSksCiAgbWV0aG9kczogewogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g6L+H5ruk6YCJ6aG5IOi/meS4quaWueazleWcqOavj+asoei+k+WFpeahhueahOWAvOWPkeeUn+WPmOWMluaXtuS8muinpuWPkQogICAgICovCiAgICBxdWVyeVNlYXJjaDogZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnlTdHJpbmcsIGNhbGxiYWNrKSB7CiAgICAgIHZhciByZXN1bHRzID0gdGhpcy5mdXNlLnNlYXJjaChxdWVyeVN0cmluZykubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaXRlbTsKICAgICAgfSk7CiAgICAgIHRoaXMucmVzdWx0cyA9IHJlc3VsdHM7CiAgICAgIGNhbGxiYWNrKHJlc3VsdHMpOwogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOiBmueEpui+k+WFpeahhgogICAgICovCiAgICBmb2N1czogZnVuY3Rpb24gZm9jdXMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMuaW5wdXQgPSAnJzsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKF90aGlzLiRyZWZzLmlucHV0KSB7CiAgICAgICAgICBfdGhpcy4kcmVmcy5pbnB1dC5mb2N1cygpOwogICAgICAgIH0KICAgICAgICAvLyDov5jljp8KICAgICAgICBfdGhpcy5zZWFyY2hUZXh0ID0gJyc7CiAgICAgICAgX3RoaXMucmVzdWx0cyA9IFtdOwogICAgICB9LCA1MDApOwogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOaOpeaUtueUqOaIt+WcqOWIl+ihqOS4remAieaLqemhueebrueahOS6i+S7tgogICAgICovCiAgICBoYW5kbGVSZXN1bHRzR3JvdXBJdGVtQ2xpY2s6IGZ1bmN0aW9uIGhhbmRsZVJlc3VsdHNHcm91cEl0ZW1DbGljayhwYXRoKSB7CiAgICAgIC8vIOWmguaenOeUqOaIt+mAieaLqeeahOWwseaYr+W9k+WJjemhtemdoiDlsLHnm7TmjqXlhbPpl63mkJzntKLpnaLmnb8KICAgICAgaWYgKHBhdGggPT09IHRoaXMuJHJvdXRlLnBhdGgpIHsKICAgICAgICB0aGlzLmhhbmRsZUVzYygpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAvLyDnlKjmiLfpgInmi6nnmoTmmK/lhbblroPpobXpnaIKICAgICAgdGhpcy5oYW5kbGVNZW51U2VsZWN0KHBhdGgpOwogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOaOpeaUtueUqOaIt+WcqOS4i+aLieiPnOWNleS4remAieS4reS6i+S7tgogICAgICovCiAgICBoYW5kbGVTZWxlY3Q6IGZ1bmN0aW9uIGhhbmRsZVNlbGVjdChfcmVmKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBwYXRoOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHBhdGggPSBfcmVmLnBhdGg7CiAgICAgICAgICAgICAgaWYgKCEocGF0aCA9PT0gX3RoaXMyLiRyb3V0ZS5wYXRoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX3RoaXMyLmhhbmRsZUVzYygpOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi4kbmV4dFRpY2soKTsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF90aGlzMi5oYW5kbGVNZW51U2VsZWN0KHBhdGgpOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLyoqCiAgICAgKiBAYXVnbWVudHMg5YWz6Zet6L6T5YWl5qGG55qE5LiL5ouJ6I+c5Y2VCiAgICAgKi8KICAgIGNsb3NlU3VnZ2VzdGlvbjogZnVuY3Rpb24gY2xvc2VTdWdnZXN0aW9uKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5pbnB1dC5hY3RpdmF0ZWQpIHsKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LnN1Z2dlc3Rpb25zID0gW107CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC5hY3RpdmF0ZWQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICogQGF1Z21lbnRzIOaOpeaUtueUqOaIt+eCueWHu+epuueZveWMuuWfn+eahOWFs+mXrQogICAgICovCiAgICBoYW5kbGVQYW5lbENsaWNrOiBmdW5jdGlvbiBoYW5kbGVQYW5lbENsaWNrKCkgewogICAgICB0aGlzLmhhbmRsZUVzYygpOwogICAgfSwKICAgIC8qKgogICAgICogQGF1Z21lbnRzIOaOpeaUtueUqOaIt+inpuWPkeeahOWFs+mXrQogICAgICovCiAgICBoYW5kbGVFc2M6IGZ1bmN0aW9uIGhhbmRsZUVzYygpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpczMuY2xvc2VTdWdnZXN0aW9uKCk7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBfdGhpczMuJG5leHRUaWNrKCk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBfdGhpczMuJGVtaXQoJ2Nsb3NlJyk7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;AAyCA;AACA;AACA;AACA;EACAA,SACAC,MACA;EACAC;IACA;MAAA;IAAA;EACA;EACAC;IACA;MACAC;MACAC;IACA;EACA;EACAC,0CACAC,4BACA,UACA,OACA;IACA;IACAC;MACA;QAAA;UACAC;QAAA,GACAC;MAAA,CACA;IACA;IACA;IACAC;MACA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC,OACA,aACA;MAEA;IACA;EAAA,EACA;EACAC;IACA;AACA;AACA;IACAC;MACA;QAAA;MAAA;MACA;MACAC;IACA;IACA;AACA;AACA;IACAC;MAAA;MACA;MACAC;QACA;UACA;QACA;QACA;QACA;QACA;MACA;IACA;IACA;AACA;AACA;IACAC;MACA;MACA;QACA;QACA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAAC;cAAA,MAEAA;gBAAA;gBAAA;cAAA;cACA;cAAA;YAAA;cAAA;cAAA,OAIA;YAAA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACA;AACA;AACA;IACAC;MACA;QACA;QACA;MACA;IACA;IACA;AACA;AACA;IACAC;MACA;IACA;IACA;AACA;AACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACA;YAAA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;EACA;AACA","names":["mixins","mixin","components","data","searchText","results","computed","mapState","resultsList","value","e","fuse","shouldSort","tokenize","threshold","location","distance","maxPatternLength","minMatchCharLength","keys","methods","querySearch","callback","focus","setTimeout","handleResultsGroupItemClick","handleSelect","path","closeSuggestion","handlePanelClick","handleEsc"],"sourceRoot":"src/layout/header-aside/components/panel-search","sources":["index.vue"],"sourcesContent":["<template>\n  <div class=\"panel-search\" flex=\"dir:top\">\n    <div class=\"panel-search__input-group\" flex-box=\"0\" flex=\"dir:top main:center cross:center\" @click.self=\"handlePanelClick\">\n      <d2-icon-svg class=\"panel-search__logo\" name=\"dvadmin\" style=\"width: 200px;height: 200px;\"/>\n      <el-autocomplete\n        class=\"panel-search__input\"\n        ref=\"input\"\n        v-model=\"searchText\"\n        suffix-icon=\"el-icon-search\"\n        placeholder=\"搜索页面\"\n        :fetch-suggestions=\"querySearch\"\n        :trigger-on-focus=\"false\"\n        :clearable=\"true\"\n        @keydown.esc.native=\"handleEsc\"\n        @select=\"handleSelect\">\n        <d2-panel-search-item slot-scope=\"{ item }\" :item=\"item\"/>\n      </el-autocomplete>\n      <div class=\"panel-search__tip\">\n        您可以使用快捷键\n        <span class=\"panel-search__key\">{{hotkey.open}}</span>\n        唤醒搜索面板，按\n        <span class=\"panel-search__key\">{{hotkey.close}}</span>\n        关闭\n      </div>\n    </div>\n    <div v-if=\"resultsList.length > 0\" class=\"panel-search__results-group\" flex-box=\"1\">\n      <el-card shadow=\"never\">\n        <div class=\"panel-search__results-group-inner\">\n          <d2-panel-search-item\n            v-for=\"(item, index) in resultsList\"\n            :key=\"index\"\n            :item=\"item\"\n            :hover-mode=\"true\"\n            @click.native=\"handleResultsGroupItemClick(item.path)\"/>\n        </div>\n      </el-card>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Fuse from 'fuse.js'\nimport { mapState } from 'vuex'\nimport mixin from '../mixin/menu'\nexport default {\n  mixins: [\n    mixin\n  ],\n  components: {\n    'd2-panel-search-item': () => import('./components/panel-search-item/index.vue')\n  },\n  data () {\n    return {\n      searchText: '',\n      results: []\n    }\n  },\n  computed: {\n    ...mapState('d2admin/search', [\n      'hotkey',\n      'pool'\n    ]),\n    // 这份数据是展示在搜索面板下面的\n    resultsList () {\n      return (this.results.length === 0 && this.searchText === '') ? this.pool.map(e => ({\n        value: e.fullTitle,\n        ...e\n      })) : this.results\n    },\n    // 根据 pool 更新 fuse 实例\n    fuse () {\n      return new Fuse(this.pool, {\n        shouldSort: true,\n        tokenize: true,\n        threshold: 0.6,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 32,\n        minMatchCharLength: 1,\n        keys: [\n          'fullTitle',\n          'path'\n        ]\n      })\n    }\n  },\n  methods: {\n    /**\n     * @description 过滤选项 这个方法在每次输入框的值发生变化时会触发\n     */\n    querySearch (queryString, callback) {\n      const results = this.fuse.search(queryString).map(e => e.item)\n      this.results = results\n      callback(results)\n    },\n    /**\n     * @description 聚焦输入框\n     */\n    focus () {\n      this.input = ''\n      setTimeout(() => {\n        if (this.$refs.input) {\n          this.$refs.input.focus()\n        }\n        // 还原\n        this.searchText = ''\n        this.results = []\n      }, 500)\n    },\n    /**\n     * @description 接收用户在列表中选择项目的事件\n     */\n    handleResultsGroupItemClick (path) {\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\n      if (path === this.$route.path) {\n        this.handleEsc()\n        return\n      }\n      // 用户选择的是其它页面\n      this.handleMenuSelect(path)\n    },\n    /**\n     * @description 接收用户在下拉菜单中选中事件\n     */\n    async handleSelect ({ path }) {\n      // 如果用户选择的就是当前页面 就直接关闭搜索面板\n      if (path === this.$route.path) {\n        this.handleEsc()\n        return\n      }\n      // 用户选择的是其它页面\n      await this.$nextTick()\n      this.handleMenuSelect(path)\n    },\n    /**\n     * @augments 关闭输入框的下拉菜单\n     */\n    closeSuggestion () {\n      if (this.$refs.input.activated) {\n        this.$refs.input.suggestions = []\n        this.$refs.input.activated = false\n      }\n    },\n    /**\n     * @augments 接收用户点击空白区域的关闭\n     */\n    handlePanelClick () {\n      this.handleEsc()\n    },\n    /**\n     * @augments 接收用户触发的关闭\n     */\n    async handleEsc () {\n      this.closeSuggestion()\n      await this.$nextTick()\n      this.$emit('close')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.panel-search {\n  margin: 20px;\n  width: 100%;\n  .panel-search__input-group {\n    height: 240px;\n    .panel-search__logo {\n      width: 80px;\n      height: 80px;\n      margin-bottom: 20px;\n    }\n    .panel-search__input {\n      width: 500px;\n    }\n    .panel-search__tip {\n      @extend %unable-select;\n      margin-top: 20px;\n      margin-bottom: 40px;\n      font-size: 12px;\n      color: $color-text-sub;\n      .panel-search__key {\n        padding: 1px 5px;\n        margin: 0px 2px;\n        border-radius: 2px;\n        background-color: $color-text-normal;\n        color: $color-bg;\n      }\n    }\n  }\n  .panel-search__results-group {\n    overflow: auto;\n    margin-bottom: -20px;\n    .panel-search__results-group-inner {\n      margin: -20px;\n    }\n  }\n}\n</style>\n"]}]}