{"remainingRequest":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/raviailani/Downloads/django-vue-admin/web/src/components/importExcel/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/raviailani/Downloads/django-vue-admin/web/src/components/importExcel/index.vue","mtime":1674694301481},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js","mtime":1674694549283},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js","mtime":1674694549360}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB1dGlsIGZyb20gJ0AvbGlicy91dGlsJwppbXBvcnQgeyByZXF1ZXN0LCBkb3dubG9hZEZpbGUgfSBmcm9tICdAL2FwaS9zZXJ2aWNlJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdpbXBvcnRFeGNlbCcsCiAgaW5qZWN0OiBbJ3JlZnJlc2hWaWV3J10sCiAgcHJvcHM6IHsKICAgIHVwbG9hZDogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQgKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAvLyDmmK/lkKbmmL7npLrlvLnlh7rlsYIKICAgICAgICAgIG9wZW46IGZhbHNlLAogICAgICAgICAgLy8g5by55Ye65bGC5qCH6aKYCiAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAvLyDmmK/lkKbnpoHnlKjkuIrkvKAKICAgICAgICAgIGlzVXBsb2FkaW5nOiBmYWxzZSwKICAgICAgICAgIC8vIOaYr+WQpuabtOaWsOW3sue7j+WtmOWcqOeahOeUqOaIt+aVsOaNrgogICAgICAgICAgdXBkYXRlU3VwcG9ydDogMCwKICAgICAgICAgIC8vIOiuvue9ruS4iuS8oOeahOivt+axguWktOmDqAogICAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiAnSldUICcgKyB1dGlsLmNvb2tpZXMuZ2V0KCd0b2tlbicpIH0sCiAgICAgICAgICAvLyDkuIrkvKDnmoTlnLDlnYAKICAgICAgICAgIHVybDogdXRpbC5iYXNlVVJMKCkgKyAnYXBpL3N5c3RlbS9maWxlLycKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhcGk6IHsgLy8g5a+85YWl5o6l5Y+j5Zyw5Z2ACiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdCAoKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZAogICAgICB9CiAgICB9LAogICAgZmllbGRPcHRpb25zOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0ICgpIHsKICAgICAgICByZXR1cm4gW10KICAgICAgfQogICAgfQogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLyoqIOWvvOWFpeaMiemSruaTjeS9nCAqLwogICAgaGFuZGxlSW1wb3J0ICgpIHsKICAgICAgdGhpcy51cGxvYWQub3BlbiA9IHRydWUKICAgIH0sCiAgICAvKiog5LiL6L295qih5p2/5pON5L2cICovCiAgICBpbXBvcnRUZW1wbGF0ZSAoKSB7CiAgICAgIGRvd25sb2FkRmlsZSh7CiAgICAgICAgdXJsOiB0aGlzLmFwaSArICdpbXBvcnRfZGF0YS8nLAogICAgICAgIHBhcmFtczoge30sCiAgICAgICAgbWV0aG9kOiAnZ2V0JwogICAgICB9KQogICAgfSwKICAgIC8qKioKICAgICAqIOaJuemHj+abtOaWsOaooeadvwogICAgICovCiAgICB1cGRhdGVUZW1wbGF0ZSAoKSB7CiAgICAgIGRvd25sb2FkRmlsZSh7CiAgICAgICAgdXJsOiB0aGlzLmFwaSArICd1cGRhdGVfdGVtcGxhdGUvJywKICAgICAgICBwYXJhbXM6IHt9LAogICAgICAgIG1ldGhvZDogJ2dldCcKICAgICAgfSkKICAgIH0sCiAgICAvLyDmlofku7bkuIrkvKDkuK3lpITnkIYKICAgIGhhbmRsZUZpbGVVcGxvYWRQcm9ncmVzcyAoZXZlbnQsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMudXBsb2FkLmlzVXBsb2FkaW5nID0gdHJ1ZQogICAgfSwKICAgIC8vIOaWh+S7tuS4iuS8oOaIkOWKn+WkhOeQhgogICAgaGFuZGxlRmlsZVN1Y2Nlc3MgKHJlc3BvbnNlLCBmaWxlLCBmaWxlTGlzdCkgewogICAgICBjb25zdCB0aGF0ID0gdGhpcwogICAgICAvLyB0aGF0LnVwbG9hZC5vcGVuID0gZmFsc2UKICAgICAgdGhhdC51cGxvYWQuaXNVcGxvYWRpbmcgPSBmYWxzZQogICAgICB0aGF0LmxvYWRpbmcgPSB0cnVlCiAgICAgIHRoYXQuJHJlZnMudXBsb2FkLmNsZWFyRmlsZXMoKQogICAgICAvLyDmmK/lkKbmm7TmlrDlt7Lnu4/lrZjlnKjnmoTnlKjmiLfmlbDmja4KICAgICAgcmV0dXJuIHJlcXVlc3QoewogICAgICAgIHVybDogdXRpbC5iYXNlVVJMKCkgKyB0aGF0LmFwaSArICdpbXBvcnRfZGF0YS8nLAogICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIHVybDogcmVzcG9uc2UuZGF0YS51cmwKICAgICAgICB9CiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoYXQubG9hZGluZyA9IGZhbHNlCiAgICAgICAgdGhhdC4kYWxlcnQoJ+WvvOWFpeaIkOWKnycsICflr7zlhaXlrozmiJAnLCB7CiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICBjYWxsYmFjazogYWN0aW9uID0+IHsKICAgICAgICAgICAgdGhhdC5yZWZyZXNoVmlldygpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSkKICAgIH0sCiAgICAvLyDmj5DkuqTkuIrkvKDmlofku7YKICAgIHN1Ym1pdEZpbGVGb3JtICgpIHsKICAgICAgdGhpcy4kcmVmcy51cGxvYWQuc3VibWl0KCkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAwCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/importExcel","sourcesContent":["<template>\n  <div style=\"display: inline-block\">\n    <el-button size=\"small\" type=\"success\" icon=\"el-icon-upload\" @click=\"handleImport\">\n      <slot>导入</slot>\n    </el-button>\n    <el-dialog :title=\"upload.title\" :visible.sync=\"upload.open\" width=\"400px\" append-to-body>\n      <div v-loading=\"loading\">\n        <el-upload\n          ref=\"upload\"\n          :limit=\"1\"\n          accept=\".xlsx, .xls\"\n          :headers=\"upload.headers\"\n          :action=\"upload.url\"\n          :disabled=\"upload.isUploading\"\n          :on-progress=\"handleFileUploadProgress\"\n          :on-success=\"handleFileSuccess\"\n          :auto-upload=\"false\"\n          drag\n        >\n          <i class=\"el-icon-upload\"/>\n          <div class=\"el-upload__text\">\n            将文件拖到此处，或\n            <em>点击上传</em>\n          </div>\n          <div slot=\"tip\" class=\"el-upload__tip\" style=\"color:red\">提示：仅允许导入“xls”或“xlsx”格式文件！</div>\n        </el-upload>\n        <div>\n          <el-button type=\"warning\" style=\"font-size:14px;margin-top: 20px\" @click=\"importTemplate\">下载导入模板</el-button>\n          <el-button type=\"warning\" style=\"font-size:14px;margin-top: 20px\" @click=\"updateTemplate\">批量更新模板</el-button>\n        </div>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" :disabled=\"loading\" @click=\"submitFileForm\">确 定</el-button>\n        <el-button :disabled=\"loading\" @click=\"upload.open = false\">取 消</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport util from '@/libs/util'\nimport { request, downloadFile } from '@/api/service'\n\nexport default {\n  name: 'importExcel',\n  inject: ['refreshView'],\n  props: {\n    upload: {\n      type: Object,\n      default () {\n        return {\n          // 是否显示弹出层\n          open: false,\n          // 弹出层标题\n          title: '',\n          // 是否禁用上传\n          isUploading: false,\n          // 是否更新已经存在的用户数据\n          updateSupport: 0,\n          // 设置上传的请求头部\n          headers: { Authorization: 'JWT ' + util.cookies.get('token') },\n          // 上传的地址\n          url: util.baseURL() + 'api/system/file/'\n        }\n      }\n    },\n    api: { // 导入接口地址\n      type: String,\n      default () {\n        return undefined\n      }\n    },\n    fieldOptions: {\n      type: Array,\n      default () {\n        return []\n      }\n    }\n  },\n  data () {\n    return {\n      loading: false\n    }\n  },\n  methods: {\n    /** 导入按钮操作 */\n    handleImport () {\n      this.upload.open = true\n    },\n    /** 下载模板操作 */\n    importTemplate () {\n      downloadFile({\n        url: this.api + 'import_data/',\n        params: {},\n        method: 'get'\n      })\n    },\n    /***\n     * 批量更新模板\n     */\n    updateTemplate () {\n      downloadFile({\n        url: this.api + 'update_template/',\n        params: {},\n        method: 'get'\n      })\n    },\n    // 文件上传中处理\n    handleFileUploadProgress (event, file, fileList) {\n      this.upload.isUploading = true\n    },\n    // 文件上传成功处理\n    handleFileSuccess (response, file, fileList) {\n      const that = this\n      // that.upload.open = false\n      that.upload.isUploading = false\n      that.loading = true\n      that.$refs.upload.clearFiles()\n      // 是否更新已经存在的用户数据\n      return request({\n        url: util.baseURL() + that.api + 'import_data/',\n        method: 'post',\n        data: {\n          url: response.data.url\n        }\n      }).then(response => {\n        that.loading = false\n        that.$alert('导入成功', '导入完成', {\n          confirmButtonText: '确定',\n          callback: action => {\n            that.refreshView()\n          }\n        })\n      })\n    },\n    // 提交上传文件\n    submitFileForm () {\n      this.$refs.upload.submit()\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}