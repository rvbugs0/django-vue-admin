{"remainingRequest":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/raviailani/Downloads/django-vue-admin/web/node_modules/d2p-extends/src/full-editor/lib/d2-wang-editor/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/d2p-extends/src/full-editor/lib/d2-wang-editor/index.vue","mtime":1674694550335},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js","mtime":1674694549283},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js","mtime":1674694549360}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgppbXBvcnQgV2FuZ0VkaXRvciBmcm9tICd3YW5nZWRpdG9yJwovLyBpbXBvcnQgeyBEMnBVcGxvYWRlciB9IGZyb20gJ2QycC1leHRlbmRzJwppbXBvcnQgbG9kYXNoIGZyb20gJ2xvZGFzaCcKaW1wb3J0IHdhbmdDb25maWcgZnJvbSAnLi91dGlscy9jb25maWcnCmltcG9ydCBEMnBVcGxvYWRlciBmcm9tICcuLi8uLi8uLi91cGxvYWRlcicKaW1wb3J0IHsgZDJDcnVkUGx1cyB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2QyLWNydWQtcGx1cycKaW1wb3J0IGxvZyBmcm9tICcuLi8uLi8uLi91dGlscy91dGlsLmxvZycKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdkMnAtd2FuZy1lZGl0b3InLAogIG1peGluczogW2QyQ3J1ZFBsdXMuaW5wdXRCYXNlXSwKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6ICcnCiAgICB9LAogICAgY29uZmlnOiB7CiAgICAgIHR5cGU6IE9iamVjdAogICAgfSwKICAgIC8qKgogICAgICog5ZCM5LiA5Liq6aG16Z2i5aSa5LiqZWRpdOaXtu+8jOmcgOimgemFjee9ruS4jeWQjOeahGluZGV4CiAgICAgKi8KICAgIGluZGV4OiB7CiAgICAgIGRlZmF1bHQ6ICcxJwogICAgfSwKICAgIHVwbG9hZGVyOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fQogICAgICB9CiAgICB9CiAgfSwKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGVkaXRvcjogbnVsbCwKICAgICAgY3VycmVudFZhbHVlOiAnJywKICAgICAgb3B0aW9uczoge30KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBpZCAoKSB7CiAgICAgIHJldHVybiAnd2FuZ2VkaXRvcicgKyB0aGlzLmluZGV4CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgdmFsdWU6IHsKICAgICAgaGFuZGxlciAodmFsKSB7CiAgICAgICAgLy8g56Gu6K6k5piv5paw55qE5YC8CiAgICAgICAgaWYgKHZhbCAhPT0gdGhpcy5jdXJyZW50VmFsdWUpIHsKICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlID0gdmFsCiAgICAgICAgICAvLyDlsJ3or5Xmm7TmlrAKICAgICAgICAgIGlmICh0aGlzLmVkaXRvcikgewogICAgICAgICAgICBpZiAodGhpcy5kaXNwYXRjaCkgewogICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goJ0VsRm9ybUl0ZW0nLCAnZWwuZm9ybS5ibHVyJykKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCB2YWwpCiAgICAgICAgICAgIC8vIHRoaXMuZWRpdG9yLnR4dC5odG1sKHRoaXMudmFsdWUpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0KICB9LAogIG1vdW50ZWQgKCkgewogICAgdGhpcy5pbml0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXQgKCkgewogICAgICBjb25zdCBlZGl0b3IgPSBuZXcgV2FuZ0VkaXRvcignIycgKyB0aGlzLmlkKQogICAgICBsb2Rhc2gubWVyZ2Uod2FuZ0NvbmZpZywgdGhpcy5jb25maWcpCiAgICAgIGxvZGFzaC5tZXJnZShlZGl0b3IuY29uZmlnLCB3YW5nQ29uZmlnKQogICAgICBlZGl0b3IuY29uZmlnLm9uY2hhbmdlID0gKG5ld0h0bWwpID0+IHsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIG5ld0h0bWwpCiAgICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPSBuZXdIdG1sCiAgICAgIH0KCiAgICAgIGlmICghZWRpdG9yLmNvbmZpZy51cGxvYWRJbWdTZXJ2ZXIpIHsKICAgICAgICBlZGl0b3IuY29uZmlnLmN1c3RvbVVwbG9hZEltZyA9IGFzeW5jIChyZXN1bHRGaWxlcywgaW5zZXJ0SW1nRm4pID0+IHsKICAgICAgICAgIC8vIHJlc3VsdEZpbGVzIOaYryBpbnB1dCDkuK3pgInkuK3nmoTmlofku7bliJfooagKICAgICAgICAgIC8vIGluc2VydEltZ0ZuIOaYr+iOt+WPluWbvueJhyB1cmwg5ZCO77yM5o+S5YWl5Yiw57yW6L6R5Zmo55qE5pa55rOVCiAgICAgICAgICB2YXIgZmlsZSA9IHJlc3VsdEZpbGVzWzBdCgogICAgICAgICAgY29uc3QgaXRlbSA9IHsKICAgICAgICAgICAgc3RhdHVzOiAndXBsb2FkaW5nJywKICAgICAgICAgICAgcHJvZ3Jlc3M6IDAKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBvblByb2dyZXNzID0gKGUpID0+IHsKICAgICAgICAgICAgaXRlbS5wcm9ncmVzcyA9IGUucGVyY2VudAogICAgICAgICAgfQogICAgICAgICAgY29uc3Qgb25FcnJvciA9IChlKSA9PiB7CiAgICAgICAgICAgIGl0ZW0uc3RhdHVzID0gJ2Vycm9yJwogICAgICAgICAgICBpdGVtLm1lc3NhZ2UgPSAn5paH5Lu25LiK5Lyg5Ye66ZSZOicgKyBlLm1lc3NhZ2UKICAgICAgICAgICAgbG9nLmRlYnVnKGUpCiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBvcHRpb24gPSB7CiAgICAgICAgICAgIGZpbGU6IGZpbGUsCiAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlLm5hbWUsCiAgICAgICAgICAgIG9uUHJvZ3Jlc3MsCiAgICAgICAgICAgIG9uRXJyb3IKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByZXQgPSBhd2FpdCB0aGlzLmRvVXBsb2FkKG9wdGlvbikKICAgICAgICAgIC8vIOS4iuS8oOWbvueJh++8jOi/lOWbnue7k+aenO+8jOWwhuWbvueJh+aPkuWFpeWIsOe8lui+keWZqOS4rQogICAgICAgICAgaW5zZXJ0SW1nRm4ocmV0LnVybCkKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVkaXRvci5jcmVhdGUoKQogICAgICBlZGl0b3IudHh0Lmh0bWwodGhpcy5jdXJyZW50VmFsdWUpCiAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yCiAgICB9LAogICAgZG9VcGxvYWQgKG9wdGlvbikgewogICAgICBvcHRpb24uY29uZmlnID0gdGhpcy51cGxvYWRlcgogICAgICByZXR1cm4gdGhpcy5nZXRVcGxvYWRlcigpLnRoZW4odXBsb2FkZXIgPT4gewogICAgICAgIHJldHVybiB1cGxvYWRlci51cGxvYWQob3B0aW9uKQogICAgICB9KQogICAgfSwKICAgIGdldFVwbG9hZGVyICgpIHsKICAgICAgbGV0IHR5cGUgPSB0aGlzLnR5cGUKICAgICAgaWYgKHRoaXMudXBsb2FkZXIgIT0gbnVsbCAmJiB0aGlzLnVwbG9hZGVyLnR5cGUgIT0gbnVsbCkgewogICAgICAgIHR5cGUgPSB0aGlzLnVwbG9hZGVyLnR5cGUKICAgICAgfQogICAgICByZXR1cm4gRDJwVXBsb2FkZXIuZ2V0VXBsb2FkZXIodHlwZSkKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQgKGZpbGUpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0VXBsb2FkZXIoKS5iZWZvcmVVcGxvYWQoZmlsZSkKICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3kgKCkgewogICAgLy8g6LCD55So6ZSA5q+BIEFQSSDlr7nlvZPliY3nvJbovpHlmajlrp7kvovov5vooYzplIDmr4EKICAgIHRoaXMuZWRpdG9yLmRlc3Ryb3koKQogICAgdGhpcy5lZGl0b3IgPSBudWxsCiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/d2p-extends/src/full-editor/lib/d2-wang-editor","sourcesContent":["<template>\n  <div class=\"d2p-wangeditor\">\n    <div :id=\"id\"></div>\n    <textarea name=\"\" class=\"wang-editor-preview\" readonly v-model=\"currentValue\"></textarea>\n  </div>\n</template>\n\n<script>\n\nimport WangEditor from 'wangeditor'\n// import { D2pUploader } from 'd2p-extends'\nimport lodash from 'lodash'\nimport wangConfig from './utils/config'\nimport D2pUploader from '../../../uploader'\nimport { d2CrudPlus } from '../../../utils/d2-crud-plus'\nimport log from '../../../utils/util.log'\nexport default {\n  name: 'd2p-wang-editor',\n  mixins: [d2CrudPlus.inputBase],\n  props: {\n    value: {\n      type: String,\n      required: false,\n      default: ''\n    },\n    config: {\n      type: Object\n    },\n    /**\n     * 同一个页面多个edit时，需要配置不同的index\n     */\n    index: {\n      default: '1'\n    },\n    uploader: {\n      type: Object,\n      default: () => {\n        return {}\n      }\n    }\n  },\n  data () {\n    return {\n      editor: null,\n      currentValue: '',\n      options: {}\n    }\n  },\n  computed: {\n    id () {\n      return 'wangeditor' + this.index\n    }\n  },\n  watch: {\n    value: {\n      handler (val) {\n        // 确认是新的值\n        if (val !== this.currentValue) {\n          this.currentValue = val\n          // 尝试更新\n          if (this.editor) {\n            if (this.dispatch) {\n              this.dispatch('ElFormItem', 'el.form.blur')\n            }\n            this.$emit('change', val)\n            // this.editor.txt.html(this.value)\n          }\n        }\n      },\n      immediate: true\n    }\n  },\n  mounted () {\n    this.init()\n  },\n  methods: {\n    init () {\n      const editor = new WangEditor('#' + this.id)\n      lodash.merge(wangConfig, this.config)\n      lodash.merge(editor.config, wangConfig)\n      editor.config.onchange = (newHtml) => {\n        this.$emit('input', newHtml)\n        this.currentValue = newHtml\n      }\n\n      if (!editor.config.uploadImgServer) {\n        editor.config.customUploadImg = async (resultFiles, insertImgFn) => {\n          // resultFiles 是 input 中选中的文件列表\n          // insertImgFn 是获取图片 url 后，插入到编辑器的方法\n          var file = resultFiles[0]\n\n          const item = {\n            status: 'uploading',\n            progress: 0\n          }\n\n          const onProgress = (e) => {\n            item.progress = e.percent\n          }\n          const onError = (e) => {\n            item.status = 'error'\n            item.message = '文件上传出错:' + e.message\n            log.debug(e)\n          }\n          const option = {\n            file: file,\n            fileName: file.name,\n            onProgress,\n            onError\n          }\n\n          const ret = await this.doUpload(option)\n          // 上传图片，返回结果，将图片插入到编辑器中\n          insertImgFn(ret.url)\n        }\n      }\n\n      editor.create()\n      editor.txt.html(this.currentValue)\n      this.editor = editor\n    },\n    doUpload (option) {\n      option.config = this.uploader\n      return this.getUploader().then(uploader => {\n        return uploader.upload(option)\n      })\n    },\n    getUploader () {\n      let type = this.type\n      if (this.uploader != null && this.uploader.type != null) {\n        type = this.uploader.type\n      }\n      return D2pUploader.getUploader(type)\n    },\n    beforeUpload (file) {\n      return this.getUploader().beforeUpload(file)\n    }\n  },\n  beforeDestroy () {\n    // 调用销毁 API 对当前编辑器实例进行销毁\n    this.editor.destroy()\n    this.editor = null\n  }\n}\n</script>\n<style lang=\"scss\">\n.d2p-wangeditor{\n  .wang-editor-preview{display: none;}\n\n  .w-e-menu .w-e-panel-container .w-e-panel-tab-content input[type=text] {\n    height: auto;\n    }\n\n}\n</style>\n"]}]}