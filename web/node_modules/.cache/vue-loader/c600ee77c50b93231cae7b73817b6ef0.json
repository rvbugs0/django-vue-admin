{"remainingRequest":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/raviailani/Downloads/django-vue-admin/web/src/layout/header-aside/components/header-user/userinfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/raviailani/Downloads/django-vue-admin/web/src/layout/header-aside/components/header-user/userinfo.vue","mtime":1674694301484},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/babel-loader/lib/index.js","mtime":1674694549283},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/cache-loader/dist/cjs.js","mtime":1674694548948},{"path":"/Users/raviailani/Downloads/django-vue-admin/web/node_modules/vue-loader/lib/index.js","mtime":1674694549360}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB1dGlsIGZyb20gJ0AvbGlicy91dGlsLmpzJwppbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnQC9hcGkvc2VydmljZScKaW1wb3J0IHsgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndXNlckluZm8nLAogIGRhdGEgKCkgewogICAgdmFyIHZhbGlkYXRlUGFzcyA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsKICAgICAgY29uc3QgcHdkUmVnZXggPSBuZXcgUmVnRXhwKCcoPz0uKlswLTldKSg/PS4qW2EtekEtWl0pLns4LDMwfScpCiAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+i+k+WFpeWvhueggScpKQogICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSB0aGlzLnVzZXJQYXNzd29yZEluZm8ub2xkUGFzc3dvcmQpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+WOn+WvhueggeS4juaWsOWvhueggeS4gOiHtCcpKQogICAgICB9IGVsc2UgaWYgKCFwd2RSZWdleC50ZXN0KHZhbHVlKSkgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign5oKo55qE5a+G56CB5aSN5p2C5bqm5aSq5L2OKOWvhueggeS4reW/hemhu+WMheWQq+Wtl+avjeOAgeaVsOWtlyknKSkKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy51c2VyUGFzc3dvcmRJbmZvLm5ld1Bhc3N3b3JkMiAhPT0gJycpIHsKICAgICAgICAgIHRoaXMuJHJlZnMudXNlclBhc3N3b3JkRm9ybS52YWxpZGF0ZUZpZWxkKCduZXdQYXNzd29yZDInKQogICAgICAgIH0KICAgICAgICBjYWxsYmFjaygpCiAgICAgIH0KICAgIH0KICAgIHZhciB2YWxpZGF0ZVBhc3MyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgPT09ICcnKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfor7flho3mrKHovpPlhaXlr4bnoIEnKSkKICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gdGhpcy51c2VyUGFzc3dvcmRJbmZvLm5ld1Bhc3N3b3JkKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfkuKTmrKHovpPlhaXlr4bnoIHkuI3kuIDoh7QhJykpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKQogICAgICB9CiAgICB9CiAgICByZXR1cm4gewogICAgICBwb3NpdGlvbjogJ2xlZnQnLAogICAgICBhY3RpdmVOYW1lOiAndXNlckluZm8nLAogICAgICBhY3Rpb246IHV0aWwuYmFzZVVSTCgpICsgJ2FwaS9zeXN0ZW0vZmlsZS8nLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgQXV0aG9yaXphdGlvbjogJ0pXVCAnICsgdXRpbC5jb29raWVzLmdldCgndG9rZW4nKQogICAgICB9LAogICAgICBmaWxlTGlzdDogW10sCiAgICAgIHVzZXJJbmZvOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgZ2VuZGVyOiAnJywKICAgICAgICBtb2JpbGU6ICcnLAogICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgZW1haWw6ICcnCiAgICAgIH0sCiAgICAgIHVzZXJJbmZvcnVsZXM6IHsKICAgICAgICBuYW1lOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeaYteensCcsIHRyaWdnZXI6ICdibHVyJyB9XSwKICAgICAgICBtb2JpbGU6IFt7IHBhdHRlcm46IC9eMVszLTldXGR7OX0kLywgbWVzc2FnZTogJ+ivt+i+k+WFpeato+ehruaJi+acuuWPtycgfV0KICAgICAgfSwKICAgICAgdXNlclBhc3N3b3JkSW5mbzogewogICAgICAgIG9sZFBhc3N3b3JkOiAnJywKICAgICAgICBuZXdQYXNzd29yZDogJycsCiAgICAgICAgbmV3UGFzc3dvcmQyOiAnJwogICAgICB9LAogICAgICBwYXNzd29yZFJ1bGVzOiB7CiAgICAgICAgb2xkUGFzc3dvcmQ6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXljp/lr4bnoIEnLAogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIG5ld1Bhc3N3b3JkOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogJ2JsdXInIH1dLAogICAgICAgIG5ld1Bhc3N3b3JkMjogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MyLCB0cmlnZ2VyOiAnYmx1cicgfV0KICAgICAgfQogICAgfQogIH0sCiAgbW91bnRlZCAoKSB7CiAgICB0aGlzLmdldEN1cnJlbnRVc2VySW5mbygpCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKCdkMmFkbWluL2FjY291bnQnLCBbJ2xvZ291dCddKSwKICAgIC8qKgogICAgICog6I635Y+W5b2T5YmN55So5oi35L+h5oGvCiAgICAgKi8KICAgIGdldEN1cnJlbnRVc2VySW5mbyAoKSB7CiAgICAgIGNvbnN0IF9zZWxmID0gdGhpcwogICAgICByZXR1cm4gcmVxdWVzdCh7CiAgICAgICAgdXJsOiAnL2FwaS9zeXN0ZW0vdXNlci91c2VyX2luZm8vJywKICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgIHBhcmFtczoge30KICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgX3NlbGYudXNlckluZm8gPSByZXMuZGF0YQogICAgICB9KQogICAgfSwKICAgIC8qKgogICAgICog5pu05paw55So5oi35L+h5oGvCiAgICAgKi8KICAgIHVwZGF0ZUluZm8gKCkgewogICAgICBjb25zdCBfc2VsZiA9IHRoaXMKCiAgICAgIF9zZWxmLiRyZWZzLnVzZXJJbmZvRm9ybS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGNvbnN0IHVzZXJJbmZvID0gX3NlbGYudXNlckluZm8KICAgICAgICAgIGRlbGV0ZSB1c2VySW5mby5yb2xlCiAgICAgICAgICByZXF1ZXN0KHsKICAgICAgICAgICAgdXJsOiAnL2FwaS9zeXN0ZW0vdXNlci91cGRhdGVfdXNlcl9pbmZvLycsCiAgICAgICAgICAgIG1ldGhvZDogJ3B1dCcsCiAgICAgICAgICAgIGRhdGE6IHVzZXJJbmZvCiAgICAgICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgX3NlbGYuJG1lc3NhZ2Uuc3VjY2Vzcygn5L+u5pS55oiQ5YqfJykKICAgICAgICAgICAgX3NlbGYuZ2V0Q3VycmVudFVzZXJJbmZvKCkKICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOagoemqjOWksei0pQogICAgICAgICAgLy8g55m75b2V6KGo5Y2V5qCh6aqM5aSx6LSlCiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfooajljZXmoKHpqozlpLHotKXvvIzor7fmo4Dmn6UnKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDph43nva4KICAgIHJlc2V0Rm9ybSAobmFtZSkgewogICAgICBjb25zdCBfc2VsZiA9IHRoaXMKICAgICAgaWYgKG5hbWUgPT09ICdpbmZvJykgewogICAgICAgIF9zZWxmLmdldEN1cnJlbnRVc2VySW5mbygpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3NlbGYudXNlclBhc3N3b3JkRm9ybSA9IHt9CiAgICAgIH0KICAgIH0sCiAgICAvLyB0YWLliIfmjaIKICAgIGhhbmRsZUNsaWNrICh0YWIsIGV2ZW50KSB7CiAgICAgIGNvbnN0IF9zZWxmID0gdGhpcwogICAgICBpZiAodGFiLnBhbmVOYW1lID09PSAndXNlckluZm8nKSB7CiAgICAgICAgX3NlbGYuJHJlZnMudXNlclBhc3N3b3JkRm9ybS5yZXNldEZpZWxkcygpCiAgICAgICAgX3NlbGYuZ2V0Q3VycmVudFVzZXJJbmZvKCkKICAgICAgfSBlbHNlIHsKICAgICAgICBfc2VsZi4kcmVmcy51c2VySW5mb0Zvcm0ucmVzZXRGaWVsZHMoKQogICAgICB9CiAgICB9LAogICAgLyoqCiAgICAgKiDph43mlrDorr7nva7lr4bnoIEKICAgICAqLwogICAgc2V0dGluZ1Bhc3N3b3JkICgpIHsKICAgICAgY29uc3QgX3NlbGYgPSB0aGlzCgogICAgICBfc2VsZi4kcmVmcy51c2VyUGFzc3dvcmRGb3JtLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgY29uc3QgdXNlcklkID0gdXRpbC5jb29raWVzLmdldCgndXVpZCcpCiAgICAgICAgICBpZiAodXNlcklkKSB7CiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3NlbGYudXNlclBhc3N3b3JkSW5mbykpCiAgICAgICAgICAgIHBhcmFtcy5vbGRQYXNzd29yZCA9IF9zZWxmLiRtZDUocGFyYW1zLm9sZFBhc3N3b3JkKQogICAgICAgICAgICBwYXJhbXMubmV3UGFzc3dvcmQgPSBfc2VsZi4kbWQ1KHBhcmFtcy5uZXdQYXNzd29yZCkKICAgICAgICAgICAgcGFyYW1zLm5ld1Bhc3N3b3JkMiA9IF9zZWxmLiRtZDUocGFyYW1zLm5ld1Bhc3N3b3JkMikKICAgICAgICAgICAgcmVxdWVzdCh7CiAgICAgICAgICAgICAgdXJsOiAnL2FwaS9zeXN0ZW0vdXNlci8nICsgdXNlcklkICsgJy9jaGFuZ2VfcGFzc3dvcmQvJywKICAgICAgICAgICAgICBtZXRob2Q6ICdwdXQnLAogICAgICAgICAgICAgIGRhdGE6IHBhcmFtcwogICAgICAgICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICBfc2VsZi5hY3RpdmVOYW1lID0gJ3VzZXJJbmZvJwogICAgICAgICAgICAgIF9zZWxmLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/ruaUueaIkOWKnycpCiAgICAgICAgICAgICAgX3NlbGYubG9nb3V0KHt9KQogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDmoKHpqozlpLHotKUKICAgICAgICAgIC8vIOeZu+W9leihqOWNleagoemqjOWksei0pQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6KGo5Y2V5qCh6aqM5aSx6LSl77yM6K+35qOA5p+lJykKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgLyoqCiAgICAgKiDlpLTlg4/kuIrkvKAKICAgICAqIEBwYXJhbSByZXMKICAgICAqIEBwYXJhbSBmaWxlCiAgICAgKi8KICAgIGhhbmRsZUF2YXRhclN1Y2Nlc3MgKHJlcywgZmlsZSkgewogICAgICB0aGlzLnVzZXJJbmZvLmF2YXRhciA9IHJlcwogICAgfQogIH0KfQo="},{"version":3,"sources":["userinfo.vue"],"names":[],"mappings":";AAmHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"userinfo.vue","sourceRoot":"src/layout/header-aside/components/header-user","sourcesContent":["<template>\n  <d2-container class=\"page\">\n    <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\n      <el-tab-pane label=\"用户设置\" name=\"userInfo\">\n        <el-row :gutter=\"20\">\n          <el-col :span=\"10\" :offset=\"6\">\n            <el-form\n              ref=\"userInfoForm\"\n              label-width=\"100px\"\n              :model=\"userInfo\"\n              required-asterisk\n              :rules=\"userInforules\"\n              :label-position=\"position\"\n              center\n            >\n              <el-form-item prop=\"avatar\" label=\"头像\">\n                <d2p-cropper-uploader :value=\"userInfo.avatar || '/image/avatar.png'\" @input=\"handleAvatarSuccess\"/>\n              </el-form-item>\n              <el-form-item prop=\"name\" required label=\"昵称\">\n                <el-input v-model=\"userInfo.name\" clearable></el-input>\n              </el-form-item>\n              <el-form-item label=\"电话号码\" required prop=\"mobile\">\n                <el-input v-model=\"userInfo.mobile\" clearable></el-input>\n              </el-form-item>\n              <el-form-item label=\"邮箱\" prop=\"email\">\n                <el-input v-model=\"userInfo.email\" clearable></el-input>\n              </el-form-item>\n              <el-form-item label=\"性別\" prop=\"gender\">\n                <el-radio-group v-model=\"userInfo.gender\">\n                  <el-radio :label=\"1\">男</el-radio>\n                  <el-radio :label=\"0\">女</el-radio>\n                  <el-radio :label=\"-1\">未知</el-radio>\n                </el-radio-group>\n              </el-form-item>\n              <el-form-item label=\"用户名\" prop=\"dept\">\n                <el-input :value=\"userInfo.username\" clearable disabled></el-input>\n              </el-form-item>\n              <el-form-item label=\"所属部门\" prop=\"dept\">\n                <el-input :value=\"userInfo.dept_info && userInfo.dept_info.dept_name\" clearable disabled></el-input>\n              </el-form-item>\n              <el-form-item label=\"当前角色\" prop=\"role\">\n                <el-select :value=\"userInfo.role\" multiple placeholder=\"请选择\" disabled style=\"width: 100%;\">\n                  <el-option\n                    v-for=\"item in userInfo.role_info\"\n                    :key=\"item.id\"\n                    :label=\"item.name\"\n                    :value=\"item.id\">\n                  </el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item>\n                <el-button @click=\"updateInfo\" type=\"primary\">\n                  <i class=\"fa fa-check\"></i>\n                  更新\n                </el-button>\n                <el-button @click=\"resetForm('info')\" type=\"info\">\n                  <i class=\"fa fa-reply-all\"></i>\n                  重置\n                </el-button>\n              </el-form-item>\n            </el-form>\n          </el-col>\n        </el-row>\n      </el-tab-pane>\n      <el-tab-pane label=\"密码设置\" name=\"passwrod\">\n        <el-row :gutter=\"20\">\n          <el-col :span=\"10\" :offset=\"6\">\n            <el-form\n              ref=\"userPasswordForm\"\n              :model=\"userPasswordInfo\"\n              required-asterisk\n              label-width=\"100px\"\n              :label-position=\"position\"\n              :rules=\"passwordRules\"\n              center\n            >\n              <el-form-item label=\"原密码\" required prop=\"oldPassword\">\n                <el-input\n                  v-model=\"userPasswordInfo.oldPassword\"\n                  placeholder=\"请输入原始密码\"\n                  clearable\n                ></el-input>\n              </el-form-item>\n              <el-form-item required prop=\"newPassword\" label=\"新密码\">\n                <el-input\n                  type=\"password\"\n                  v-model=\"userPasswordInfo.newPassword\"\n                  placeholder=\"请输入新密码\"\n                  clearable\n                ></el-input>\n              </el-form-item>\n              <el-form-item required prop=\"newPassword2\" label=\"确认密码\">\n                <el-input\n                  type=\"password\"\n                  v-model=\"userPasswordInfo.newPassword2\"\n                  placeholder=\"请再次输入新密码\"\n                  clearable\n                ></el-input>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" @click=\"settingPassword\">\n                  <i class=\"fa fa-check\"></i>提交\n                </el-button>\n                <el-button @click=\"resetForm('passwordForm')\" type=\"info\">\n                  <i class=\"fa fa-reply-all\"></i>重置\n                </el-button>\n              </el-form-item>\n            </el-form>\n          </el-col>\n        </el-row>\n      </el-tab-pane>\n    </el-tabs>\n  </d2-container>\n</template>\n<script>\nimport util from '@/libs/util.js'\nimport { request } from '@/api/service'\nimport { mapActions } from 'vuex'\nexport default {\n  name: 'userInfo',\n  data () {\n    var validatePass = (rule, value, callback) => {\n      const pwdRegex = new RegExp('(?=.*[0-9])(?=.*[a-zA-Z]).{8,30}')\n      if (value === '') {\n        callback(new Error('请输入密码'))\n      } else if (value === this.userPasswordInfo.oldPassword) {\n        callback(new Error('原密码与新密码一致'))\n      } else if (!pwdRegex.test(value)) {\n        callback(new Error('您的密码复杂度太低(密码中必须包含字母、数字)'))\n      } else {\n        if (this.userPasswordInfo.newPassword2 !== '') {\n          this.$refs.userPasswordForm.validateField('newPassword2')\n        }\n        callback()\n      }\n    }\n    var validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'))\n      } else if (value !== this.userPasswordInfo.newPassword) {\n        callback(new Error('两次输入密码不一致!'))\n      } else {\n        callback()\n      }\n    }\n    return {\n      position: 'left',\n      activeName: 'userInfo',\n      action: util.baseURL() + 'api/system/file/',\n      headers: {\n        Authorization: 'JWT ' + util.cookies.get('token')\n      },\n      fileList: [],\n      userInfo: {\n        name: '',\n        gender: '',\n        mobile: '',\n        avatar: '',\n        email: ''\n      },\n      userInforules: {\n        name: [{ required: true, message: '请输入昵称', trigger: 'blur' }],\n        mobile: [{ pattern: /^1[3-9]\\d{9}$/, message: '请输入正确手机号' }]\n      },\n      userPasswordInfo: {\n        oldPassword: '',\n        newPassword: '',\n        newPassword2: ''\n      },\n      passwordRules: {\n        oldPassword: [\n          {\n            required: true,\n            message: '请输入原密码',\n            trigger: 'blur'\n          }\n        ],\n        newPassword: [{ validator: validatePass, trigger: 'blur' }],\n        newPassword2: [{ validator: validatePass2, trigger: 'blur' }]\n      }\n    }\n  },\n  mounted () {\n    this.getCurrentUserInfo()\n  },\n  methods: {\n    ...mapActions('d2admin/account', ['logout']),\n    /**\n     * 获取当前用户信息\n     */\n    getCurrentUserInfo () {\n      const _self = this\n      return request({\n        url: '/api/system/user/user_info/',\n        method: 'get',\n        params: {}\n      }).then((res) => {\n        _self.userInfo = res.data\n      })\n    },\n    /**\n     * 更新用户信息\n     */\n    updateInfo () {\n      const _self = this\n\n      _self.$refs.userInfoForm.validate((valid) => {\n        if (valid) {\n          const userInfo = _self.userInfo\n          delete userInfo.role\n          request({\n            url: '/api/system/user/update_user_info/',\n            method: 'put',\n            data: userInfo\n          }).then((res) => {\n            _self.$message.success('修改成功')\n            _self.getCurrentUserInfo()\n          })\n        } else {\n          // 校验失败\n          // 登录表单校验失败\n          this.$message.error('表单校验失败，请检查')\n        }\n      })\n    },\n    // 重置\n    resetForm (name) {\n      const _self = this\n      if (name === 'info') {\n        _self.getCurrentUserInfo()\n      } else {\n        _self.userPasswordForm = {}\n      }\n    },\n    // tab切换\n    handleClick (tab, event) {\n      const _self = this\n      if (tab.paneName === 'userInfo') {\n        _self.$refs.userPasswordForm.resetFields()\n        _self.getCurrentUserInfo()\n      } else {\n        _self.$refs.userInfoForm.resetFields()\n      }\n    },\n    /**\n     * 重新设置密码\n     */\n    settingPassword () {\n      const _self = this\n\n      _self.$refs.userPasswordForm.validate((valid) => {\n        if (valid) {\n          const userId = util.cookies.get('uuid')\n          if (userId) {\n            const params = JSON.parse(JSON.stringify(_self.userPasswordInfo))\n            params.oldPassword = _self.$md5(params.oldPassword)\n            params.newPassword = _self.$md5(params.newPassword)\n            params.newPassword2 = _self.$md5(params.newPassword2)\n            request({\n              url: '/api/system/user/' + userId + '/change_password/',\n              method: 'put',\n              data: params\n            }).then((res) => {\n              _self.activeName = 'userInfo'\n              _self.$message.success('修改成功')\n              _self.logout({})\n            })\n          }\n        } else {\n          // 校验失败\n          // 登录表单校验失败\n          this.$message.error('表单校验失败，请检查')\n        }\n      })\n    },\n    /**\n     * 头像上传\n     * @param res\n     * @param file\n     */\n    handleAvatarSuccess (res, file) {\n      this.userInfo.avatar = res\n    }\n  }\n}\n</script>\n"]}]}